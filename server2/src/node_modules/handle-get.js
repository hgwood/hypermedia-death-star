"use strict"

const _ = require("lodash")

module.exports = function(uri, resource, response) {
  response.format({
    "application/vnd.siren+json": () => response.send(siren(uri, resource, response))
  })
}

function siren(uri, resource) {
  return {
    class: ["location"],
    properties: {title: resource.content.title, description: resource.content.description},
    actions: _.map(resource.actions, sirenAction)
  }

  function sirenAction({method, type, fields}, name) {
    return _.assign({name, href: uri}, {method, type, fields})
  }
}
