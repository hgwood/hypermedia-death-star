"use strict"

const expressify = require("expressify")

module.exports = router => ({
  content: {
    title: "The Shadow of the Death Star",
    description: "Il est trop tard pour faire demi-tour. Vous sentez la poigne de fer de l'Empire Galactique se refermer sur vous. La lutte est vaine, mais il y a d'autres façons de remporter la victoire. Votre maîtrise des pouvoirs de l'HTTP sera indispensable à votre survie. Saurez-vous affronter l'impitoyable Vador ?",
    actions: {"this.start": "Commencer"}
  },
  actions: {
    start: {
      method: "POST",
      type: "application/x-www-form-urlencoded",
      fields: [{name: "name", type: "text"}],
      handle(request, response) {
        const gameRouter = router.newGameRouter(request.body.name)
        request.app.use(gameRouter.rootUri, expressify(gameRouter))
        response.status(201).location(gameRouter.link("landing")).send()
      }
    }
  }
})
