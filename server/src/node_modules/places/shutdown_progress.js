"use strict"

const sendPlace = require("../send-place")
const countdown = 5 // seconds

module.exports = {
  "description": `L'écran affiche: "Extinction en cours. Temps restant: ${countdown} secondes."`,
  "links": [
    {
      "description": "Regarder l'écran",
      "href": "shutdown_progress",
      "rel": ["look", "detail"]
    }
  ],
  "countdown": countdown,
  "handler": handler,
  "locationAfterCountdown": "vader"
}

function handler(place, request, response) {
  if (place.remaining <= 0) {
    place.location = place.locationAfterCountdown
    response.status(303).location(place.location)
  }
  sendPlace(response, place)
}
